@using System.Web.Mvc.Html
@model BoxOffice.Models.Message

@{
    ViewBag.Title = "MessageUser";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@section js
{
    <script type="text/javascript">
        var page = "#msg";
        $(document).ready(function () {
            $(page).addClass("selected");
            
            // username completion
            $("#Username").autocomplete({
                source: function (request, response) {
                    // define a function to call your Action (assuming UserController)
                    $.ajax({
                        url: 'Users/Usernames',
                        type: "GET",
                        dataType: "json",

                        // query will be the param used by your action method
                        data: { q: request.term },
                        success: function(data) {
                            response($.map(data, function(item) {
                                return { label: item, value: item };
                            }));
                        }
                    });
                },
                result: function (event, data, formatted) { // result is a separate function
                    alert(data);
                },
                minLength: 1, // require at least one character from the user
            });
        });
    </script>
}

<h2>MessageUser</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Message</legend>
        
        <div class="editor-label">
            @Html.Label("To:")
        </div>
        <div class="editor-field">
            <input class="text-box single-line" id="Username" name="Username" type="text" value="">
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ToUserID)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.ToUserID)
            @Html.ValidationMessageFor(model => model.ToUserID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.DateSent)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.DateSent)
            @Html.ValidationMessageFor(model => model.DateSent)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Text)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Text)
            @Html.ValidationMessageFor(model => model.Text)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.toAll)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.toAll)
            @Html.ValidationMessageFor(model => model.toAll)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
